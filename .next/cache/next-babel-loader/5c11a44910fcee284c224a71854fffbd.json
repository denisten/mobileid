{"ast":null,"code":"import { MongoClient } from 'mongodb';\nexport default (async (req, res) => {\n  const mongoClient = new MongoClient(process.env.dataBaseUrl);\n  mongoClient.connect(function (err, client) {\n    if (err) {\n      return console.log(err);\n    } // взаимодействие с базой данных\n\n\n    console.log('connected to db');\n    const db = mongoClient.db(\"usersdb\");\n    const collection = db.collection(\"users\");\n    let user = {\n      name: \"Tom\",\n      age: 23\n    };\n    collection.insertOne(user, function (err, result) {\n      throw new Error();\n\n      if (err) {\n        res.status(500);\n        return console.log(err);\n      }\n\n      console.log(result.ops); // mongoClient.close();\n    });\n    client.close();\n  });\n  res.json({\n    status: 'ok'\n  });\n});","map":{"version":3,"sources":["/Users/denisten/workspace/mid-landing/pages/api/test.ts"],"names":["MongoClient","req","res","mongoClient","process","env","dataBaseUrl","connect","err","client","console","log","db","collection","user","name","age","insertOne","result","Error","status","ops","close","json"],"mappings":"AACA,SAAQA,WAAR,QAA0B,SAA1B;AAEA,gBAAe,OAAOC,GAAP,EAA4BC,GAA5B,KAAqD;AAEhE,QAAMC,WAAW,GAAG,IAAIH,WAAJ,CAAgBI,OAAO,CAACC,GAAR,CAAYC,WAA5B,CAApB;AACAH,EAAAA,WAAW,CAACI,OAAZ,CAAoB,UAASC,GAAT,EAAcC,MAAd,EAAqB;AACrC,QAAGD,GAAH,EAAO;AACH,aAAOE,OAAO,CAACC,GAAR,CAAYH,GAAZ,CAAP;AACH,KAHoC,CAIrC;;;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AAEA,UAAMC,EAAE,GAAGT,WAAW,CAACS,EAAZ,CAAe,SAAf,CAAX;AACA,UAAMC,UAAU,GAAGD,EAAE,CAACC,UAAH,CAAc,OAAd,CAAnB;AACA,QAAIC,IAAI,GAAG;AAACC,MAAAA,IAAI,EAAE,KAAP;AAAcC,MAAAA,GAAG,EAAE;AAAnB,KAAX;AACAH,IAAAA,UAAU,CAACI,SAAX,CAAqBH,IAArB,EAA2B,UAASN,GAAT,EAAcU,MAAd,EAAqB;AAC5C,YAAM,IAAIC,KAAJ,EAAN;;AACA,UAAGX,GAAH,EAAO;AACHN,QAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX;AACA,eAAOV,OAAO,CAACC,GAAR,CAAYH,GAAZ,CAAP;AACH;;AACDE,MAAAA,OAAO,CAACC,GAAR,CAAYO,MAAM,CAACG,GAAnB,EAN4C,CAO5C;AACH,KARD;AASAZ,IAAAA,MAAM,CAACa,KAAP;AACH,GApBD;AAuBIpB,EAAAA,GAAG,CAACqB,IAAJ,CAAS;AAACH,IAAAA,MAAM,EAAE;AAAT,GAAT;AAEP,CA5BD","sourcesContent":["import { NextApiRequest, NextApiResponse } from 'next';\nimport {MongoClient} from 'mongodb';\n\nexport default async (req: NextApiRequest, res: NextApiResponse) => {\n\n    const mongoClient = new MongoClient(process.env.dataBaseUrl);\n    mongoClient.connect(function(err, client){\n        if(err){\n            return console.log(err);\n        }\n        // взаимодействие с базой данных\n        console.log('connected to db')\n\n        const db = mongoClient.db(\"usersdb\");\n        const collection = db.collection(\"users\");\n        let user = {name: \"Tom\", age: 23};\n        collection.insertOne(user, function(err, result){\n            throw new Error();\n            if(err){\n                res.status(500);\n                return console.log(err);\n            }\n            console.log(result.ops);\n            // mongoClient.close();\n        });\n        client.close();\n    });\n\n\n        res.json({status: 'ok'})\n\n}\n"]},"metadata":{},"sourceType":"module"}